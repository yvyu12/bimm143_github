<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Yvonne Yu A16333006">

<title>Class 7: Machine Learning 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Class07_files/libs/clipboard/clipboard.min.js"></script>
<script src="Class07_files/libs/quarto-html/quarto.js"></script>
<script src="Class07_files/libs/quarto-html/popper.min.js"></script>
<script src="Class07_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Class07_files/libs/quarto-html/anchor.min.js"></script>
<link href="Class07_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Class07_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Class07_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Class07_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Class07_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Class 7: Machine Learning 1</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Yvonne Yu A16333006 </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<p>Today we will start our multi-part exploration of some key machine learning methods. We will begin with clustering - finding groupings in data, and then dimensionality reduction.</p>
<section id="clustering" class="level2">
<h2 class="anchored" data-anchor-id="clustering">Clustering</h2>
<p>Let’s start with “k-means” clustering. The main function in base R for this <code>kmeans()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make up some data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="at">mean =</span> <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="sc">-</span><span class="dv">3</span>), <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">3</span>))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">x =</span> tmp, <span class="at">y =</span> <span class="fu">rev</span>(tmp))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now let’s try out <code>kmeans()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>km <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(x, <span class="at">centers =</span> <span class="dv">2</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>km</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>K-means clustering with 2 clusters of sizes 30, 30

Cluster means:
          x         y
1 -3.098023  3.313902
2  3.313902 -3.098023

Clustering vector:
 [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2
[39] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2

Within cluster sum of squares by cluster:
[1] 56.99995 56.99995
 (between_SS / total_SS =  91.5 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(km)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$names
[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      

$class
[1] "kmeans"</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q. How many points in each cluster?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>km<span class="sc">$</span>size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 30 30</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q. What component of your result object details cluster assignment/membership?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>km<span class="sc">$</span>cluster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2
[39] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q. What are centers/mean values of each cluster?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>km<span class="sc">$</span>centers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          x         y
1 -3.098023  3.313902
2  3.313902 -3.098023</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q. Make a plot of your data showing your clustering results.</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">col=</span>(km<span class="sc">$</span>cluster))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(km<span class="sc">$</span>centers, <span class="at">col=</span><span class="st">"green"</span>, <span class="at">pch =</span> <span class="dv">15</span>, <span class="at">cex =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>Q. Run <code>kmeans()</code> again and cluster in 4 groups and plot the results.</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>new_km <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(x, <span class="at">centers =</span> <span class="dv">4</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">col =</span> new_km<span class="sc">$</span>cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Biased because the clustering is based on random and between the points plotted on the graph.</p>
</section>
<section id="hierarchial-clustering" class="level2">
<h2 class="anchored" data-anchor-id="hierarchial-clustering">Hierarchial Clustering</h2>
<p>This form of clustering aims to reveal the structure in your data by progressively grouping points into a ever smaller number of clusters.</p>
<p>The main function in base R for this called <code>hclust()</code>. This function does not take our input data directly, but wants a “distance matrix” that details how (dis)similar all our input points are to each other.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dist</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             1           2           3           4           5           6
2   0.91818875                                                            
3   0.40211289  1.24899931                                                
4   1.10555083  1.24518768  1.45618206                                    
5   2.70905083  1.81605164  3.06303206  2.44288435                        
6   1.45347204  1.22263921  1.45270091  2.34320678  2.54443283            
7   1.15746894  2.06806460  0.84063145  1.90413631  3.86637127  2.18719250
8   0.39189491  1.10153771  0.21394432  1.49709092  2.91642114  1.24287667
9   1.00411354  1.89980453  0.86703005  1.45569370  3.62308996  2.31973088
10  1.32627672  0.60839734  1.71380431  1.07905858  1.44425782  1.79707571
11  1.54971572  1.96639105  1.24767829  2.65484759  3.61953136  1.17212793
12  1.23148345  0.87975714  1.63276803  0.61371679  1.83235867  2.09562262
13  0.57140089  1.37769057  0.17396407  1.62812466  3.19364939  1.43861210
14  2.14718111  1.57972922  2.23457092  2.82246138  2.20116505  0.84023332
15  0.50099152  1.41781278  0.29435408  1.36060784  3.20794866  1.74512274
16  1.54755427  0.64897329  1.83723818  1.78766929  1.33648978  1.25226191
17  0.61654658  0.43205814  1.00730768  0.86909444  2.11211868  1.48264380
18  0.62903298  1.54446977  0.37335632  1.45979875  3.33683461  1.82105936
19  2.09124174  2.43563772  2.32132645  1.19153132  3.41588965  3.47919597
20  3.36022280  3.99542047  3.40424911  2.83668032  5.19668449  4.80955767
21  1.14686699  0.91971449  1.19734985  2.01374777  2.40355235  0.32958764
22  0.84751138  0.34105832  1.09037389  1.47396033  2.04843993  0.90173538
23  1.88897681  2.56647725  1.94772794  1.51914495  3.96131832  3.33844415
24  1.70279642  2.58714544  1.33818573  2.49561863  4.40071989  2.48944198
25  1.40126608  2.07825701  1.49272566  1.10586401  3.53767042  2.85387489
26  1.16905541  1.52283410  0.93454701  2.26262336  3.19774734  0.85637952
27  0.70697448  0.81055503  1.09800774  0.47831384  2.28765162  1.86509060
28  0.55531518  1.33401009  0.17687804  1.63035753  3.14923506  1.37870510
29  0.88949286  0.17944658  1.25396767  1.07386454  1.81957394  1.39210101
30  0.42391054  0.75749182  0.82027313  0.72400236  2.42099577  1.65705550
31  9.23954604  9.73689215  8.85871980 10.30798259 11.21672217  8.69173051
32  9.43413762  9.87970461  9.06293200 10.51829242 11.29247742  8.79323653
33  8.26651571  8.77657466  7.88420256  9.33207140 10.28129370  7.74819582
34  9.52374559 10.02171644  9.14262265 10.59151088 11.49977626  8.97565363
35  7.80109077  8.25377945  7.43008980  8.88560875  9.69498426  7.18136453
36  9.46031259 10.05712546  9.06496025 10.48155575 11.65203545  9.10760392
37  7.59243842  8.20065544  7.19654197  8.61242862  9.82102443  7.27882124
38  9.64263387 10.27088127  9.24414828 10.64325752 11.89922259  9.35703465
39  8.98629915  9.41531770  8.61891005 10.07501322 10.81166947  8.31918502
40  8.47761383  8.88203943  8.11613188  9.57193183 10.25298111  7.77190166
41 10.50062618 11.20010552 10.09854718 11.44040456 12.89829777 10.37835870
42 10.47748830 11.06917318 10.08241351 11.49953227 12.65251807 10.10842395
43  8.44781571  8.99385890  8.05956689  9.49805862 10.53877431  7.99781008
44  9.32496685  9.79552890  8.94896643 10.40216589 11.24123602  8.72825701
45  9.52935049  9.91064062  9.17191848 10.62673804 11.23742012  8.78201065
46  8.53275763  9.07027227  8.14575546  9.58660941 10.60457119  8.06538337
47  8.67670599  8.98182962  8.33912728  9.78172681 10.21572061  7.81681171
48  8.26195005  8.77742493  7.87871523  9.32545590 10.28858283  7.75392408
49 10.01682623 10.49214182  9.63945216 11.09163432 11.93751868  9.42551844
50  7.35885248  7.81739779  6.98722185  8.44259919  9.27203737  6.75268694
51  9.92346229 10.36116178  9.55345425 11.00911236 11.75882078  9.26715124
52  8.64523141  9.22867513  8.25175135  9.67620609 10.81420452  8.26982912
53  8.43572507  8.93081716  8.05590914  9.50634048 10.41586641  7.88833935
54  8.11284657  8.69485556  7.71979832  9.14610772 10.28298442  7.73855287
55  8.27920606  8.65910194  7.92361533  9.37771152 10.00083230  7.53467493
56 10.80742943 11.15258344 10.45724863 11.90892651 12.41493617 10.00083230
57  9.88456304 10.40554916  9.49938650 10.94285502 11.90892651  9.37771152
58  8.43566389  8.94963647  8.05254913  9.49938650 10.45724863  7.92361533
59  9.31847538  9.75293567  8.94963647 10.40554916 11.15258344  8.65910194
60  8.81692609  9.31847538  8.43566389  9.88456304 10.80742943  8.27920606
             7           8           9          10          11          12
2                                                                         
3                                                                         
4                                                                         
5                                                                         
6                                                                         
7                                                                         
8   1.03723129                                                            
9   0.53383736  1.07813180                                                
10  2.46603641  1.61128699  2.18459813                                    
11  1.53907377  1.15973815  1.91780183  2.56701311                        
12  2.27464499  1.59066280  1.90938936  0.49436892  2.67558828            
13  0.77351291  0.28118274  0.90803920  1.86719564  1.10250547  1.80286609
14  3.01002189  2.02064001  3.09242310  1.99035051  1.95163441  2.41633873
15  0.65932515  0.50245979  0.57615257  1.80872172  1.47500895  1.64614248
16  2.67424862  1.66051021  2.54248920  0.80191106  2.28371847  1.27384377
17  1.76227362  0.92322741  1.52272217  0.70973312  1.97848116  0.69735294
18  0.53021241  0.58730038  0.50463309  1.93736751  1.46418329  1.76758468
19  2.37469250  2.44344817  1.84113394  2.21328660  3.56719107  1.71903599
20  2.98677412  3.59469830  2.59036266  3.91423287  4.49995349  3.43240025
21  1.98220901  0.98347720  2.05805161  1.51302747  1.21997775  1.78120095
22  1.93073362  0.90682791  1.85036914  0.94800590  1.64344997  1.19528067
23  1.67032861  2.13116161  1.19018841  2.57775202  3.10118273  2.13232958
24  0.59242021  1.50086253  1.08303770  3.02700632  1.58368529  2.86018621
25  1.36918671  1.66433066  0.84126801  2.12628238  2.68996256  1.70636770
26  1.45169085  0.79599366  1.72298585  2.12366017  0.44360269  2.24417436
27  1.71160109  1.09095922  1.36356997  0.84475711  2.22933441  0.56323845
28  0.83330612  0.23292780  0.96274925  1.83393320  1.07478830  1.78433797
29  2.04681637  1.13154134  1.83427494  0.49532365  2.07571206  0.70460226
30  1.48810662  0.80611322  1.20255660  0.98829516  1.94790383  0.81602153
31  8.53659034  8.85798561  9.06891558 10.34230189  7.77855015 10.43830550
32  8.79517577  9.04737889  9.32899450 10.48770132  7.93927150 10.61275889
33  7.55765164  7.88616652  8.08998648  9.38069034  6.81479018  9.46885455
34  8.81736595  9.14235919  9.34946478 10.62714263  8.06338975 10.72293361
35  7.17290679  7.41440900  7.70668838  8.86134254  6.30873136  8.98109235
36  8.63007261  9.09535973  9.15043439 10.65008720  8.09370991 10.68570442
37  6.76451944  7.22900436  7.28677874  8.79051737  6.24121451  8.81889499
38  8.77218942  9.28509568  9.28550788 10.85747610  8.31504082 10.87230225
39  8.37326550  8.59816537  8.90698449 10.02360737  7.48206047 10.15721538
40  7.90249506  8.08785990  8.43528453  9.49042154  6.96112585  9.63645415
41  9.53999033 10.16490248 10.02902265 11.76668680  9.28096284 11.73004588
42  9.64702092 10.11184181 10.16671032 11.66340742  9.10459587 11.70233026
43  7.69063349  8.07282443  8.21991341  9.59421162  7.02774595  9.66130544
44  8.65526365  8.94046225  9.18867447 10.40258488  7.84526309 10.51378618
45  8.97132539  9.13872748  9.50375002 10.51858884  8.00457303 10.67770783
46  7.78561367  8.15645078  8.31561989  9.67168400  7.10475535  9.74390592
47  8.22679838  8.28486795  8.75188790  9.58592185  7.13146744  9.78161909
48  7.54615114  7.88231855  8.07816601  9.38104607  6.81464684  9.46608171
49  9.33481123  9.63301303  9.86778146 11.09906508  8.54074996 11.20801686
50  6.72998984  6.97249229  7.26374227  8.42463243  5.86951626  8.54074996
51  9.28982060  9.53619351  9.82364965 10.96936654  8.42463243 11.09906508
52  7.83839830  8.27711915  8.36252696  9.82364965  7.26374227  9.86778146
53  7.74416290  8.05358638  8.27711915  9.53619351  6.97249229  9.63301303
54  7.31304136  7.74416290  7.83839830  9.28982060  6.72998984  9.33481123
55  7.73855287  7.88833935  8.26982912  9.26715124  6.75268694  9.42551844
56 10.28298442 10.41586641 10.81420452 11.75882078  9.27203737 11.93751868
57  9.14610772  9.50634048  9.67620609 11.00911236  8.44259919 11.09163432
58  7.71979832  8.05590914  8.25175135  9.55345425  6.98722185  9.63945216
59  8.69485556  8.93081716  9.22867513 10.36116178  7.81739779 10.49214182
60  8.11284657  8.43572507  8.64523141  9.92346229  7.35885248 10.01682623
            13          14          15          16          17          18
2                                                                         
3                                                                         
4                                                                         
5                                                                         
6                                                                         
7                                                                         
8                                                                         
9                                                                         
10                                                                        
11                                                                        
12                                                                        
13                                                                        
14  2.24653681                                                            
15  0.37933219  2.51753614                                                
16  1.94156765  1.21717553  2.03900240                                    
17  1.16553863  1.96891193  1.10322234  1.07014325                        
18  0.40511795  2.60790186  0.12911351  2.16214922  1.23227168            
19  2.46585316  4.00923687  2.10336295  2.96766291  2.04308880  2.14364944
20  3.48290279  5.48646578  3.11508767  4.60041376  3.56621433  3.07967211
21  1.21288429  1.03743287  1.48221796  1.07224248  1.15481162  1.57061426
22  1.18750023  1.37836138  1.31356718  0.75502570  0.60520154  1.43131056
23  2.04084939  4.02157431  1.66506963  3.19389936  2.13441940  1.64582717
24  1.21968862  3.32953814  1.22289886  3.16112363  2.31801048  1.09667651
25  1.60282456  3.52795474  1.22349481  2.71113691  1.64652540  1.22614594
26  0.82803554  1.68917881  1.20457316  1.86151977  1.54701016  1.22887098
27  1.27136463  2.36886595  1.08565307  1.41248855  0.40062425  1.20557319
28  0.06058805  2.18595935  0.42174637  1.89029523  1.13652137  0.45850602
29  1.39733752  1.75609321  1.38873651  0.76217675  0.31686213  1.51749307
30  0.99247911  2.23290159  0.84051601  1.40236104  0.33469139  0.96616906
31  8.68503587  9.07937125  8.95645713  9.94257477  9.74603669  8.87163828
32  8.89035678  9.12582254  9.17938226 10.04521599  9.91662264  9.10133950
33  7.71041919  8.16237425  7.97939881  8.99677336  8.77789122  7.89394513
34  8.96891348  9.36042917  9.23951463 10.22663368 10.03074731  9.15433726
35  7.25759237  7.54574843  7.54826548  8.43356999  8.28528692  7.47134012
36  8.89171738  9.59307225  9.12122777 10.33948014 10.00975603  9.02309556
37  7.02341509  7.80110287  7.25205556  8.50036815  8.14505041  7.15415101
38  9.07193226  9.87224210  9.28575898 10.57788678 10.20448926  9.18347588
39  8.44694385  8.64078204  8.74222103  9.57059156  9.46041096  8.66692972
40  7.94524342  8.07590592  8.24919139  9.02182157  8.93914657  8.17793494
41  9.93074216 10.95813352 10.10343349 11.56404840 11.08784628  9.99196817
42  9.90911580 10.57834231 10.13920265 11.34399316 11.02543727 10.04104866
43  7.88560862  8.44527588  8.13980689  9.24071171  8.97528416  8.04928010
44  8.77575912  9.08764204  9.05658813  9.98043060  9.81916784  8.97528416
45  9.00177541  9.04775066  9.31012295 10.02771212  9.98043060  9.24071171
46  7.97179267  8.50308019  8.22928077  9.31012295  9.05658813  8.13980689
47  8.17360255  8.01581406  8.50308019  9.04775066  9.08764204  8.44527588
48  7.70487571  8.17360255  7.97179267  9.00177541  8.77575912  7.88560862
49  9.46608171  9.78161909  9.74390592 10.67770783 10.51378618  9.66130544
50  6.81464684  7.13146744  7.10475535  8.00457303  7.84526309  7.02774595
51  9.38104607  9.58592185  9.67168400 10.51858884 10.40258488  9.59421162
52  8.07816601  8.75188790  8.31561989  9.50375002  9.18867447  8.21991341
53  7.88231855  8.28486795  8.15645078  9.13872748  8.94046225  8.07282443
54  7.54615114  8.22679838  7.78561367  8.97132539  8.65526365  7.69063349
55  7.75392408  7.81681171  8.06538337  8.78201065  8.72825701  7.99781008
56 10.28858283 10.21572061 10.60457119 11.23742012 11.24123602 10.53877431
57  9.32545590  9.78172681  9.58660941 10.62673804 10.40216589  9.49805862
58  7.87871523  8.33912728  8.14575546  9.17191848  8.94896643  8.05956689
59  8.77742493  8.98182962  9.07027227  9.91064062  9.79552890  8.99385890
60  8.26195005  8.67670599  8.53275763  9.52935049  9.32496685  8.44781571
            19          20          21          22          23          24
2                                                                         
3                                                                         
4                                                                         
5                                                                         
6                                                                         
7                                                                         
8                                                                         
9                                                                         
10                                                                        
11                                                                        
12                                                                        
13                                                                        
14                                                                        
15                                                                        
16                                                                        
17                                                                        
18                                                                        
19                                                                        
20  1.79191532                                                            
21  3.15143061  4.50708492                                                
22  2.64548640  4.11701839  0.58661034                                    
23  0.98583726  1.47139957  3.03583464  2.66029659                        
24  2.88716835  3.23412778  2.34535495  2.40661004  2.07823935            
25  1.01797680  1.96098786  2.54750875  2.16604331  0.49433028  1.86921191
26  3.23901058  4.30842260  0.82015276  1.20149372  2.86872925  1.66101528
27  1.64249356  3.19142968  1.53557770  1.00407888  1.78511606  2.29700250
28  2.49249989  3.53247521  1.15233566  1.13558900  2.08649760  1.27104459
29  2.26534491  3.84788324  1.08198569  0.49571178  2.43225933  2.58648290
30  1.82226007  3.26579840  1.32918454  0.85511021  1.81883840  2.06282943
31 10.90083860 10.91439950  8.89292609  9.40414893 10.06432417  8.01550508
32 11.16858407 11.27442417  9.01282772  9.54275030 10.36216333  8.29525809
33  9.92217689  9.95422320  7.94157550  8.44550880  9.08823428  7.03719978
34 11.18041634 11.18147688  9.17739759  9.68893687 10.34089978  8.29452630
35  9.54743733  9.71094080  7.39362252  7.91781618  8.75520509  6.68235568
36 10.94178933 10.73727089  9.27011415  9.73715982 10.04606067  8.07081456
37  9.08651686  8.95314057  7.42882343  7.88384888  8.20279525  6.20914873
38 11.05463559 10.77031733  9.50611049  9.95647536 10.14096678  8.20279525
39 10.74791601 10.90167194  8.54304314  9.07746033  9.95647536  7.88384888
40 10.27598521 10.49476803  8.00218031  8.54304314  9.50611049  7.42882343
41 11.72204031 11.22523337 10.49476803 10.90167194 10.77031733  8.95314057
42 11.95478651 11.72204031 10.27598521 10.74791601 11.05463559  9.08651686
43 10.04104866  9.99196817  8.17793494  8.66692972  9.18347588  7.15415101
44 11.02543727 11.08784628  8.93914657  9.46041096 10.20448926  8.14505041
45 11.34399316 11.56404840  9.02182157  9.57059156 10.57788678  8.50036815
46 10.13920265 10.10343349  8.24919139  8.74222103  9.28575898  7.25205556
47 10.57834231 10.95813352  8.07590592  8.64078204  9.87224210  7.80110287
48  9.90911580  9.93074216  7.94524342  8.44694385  9.07193226  7.02341509
49 11.70233026 11.73004588  9.63645415 10.15721538 10.87230225  8.81889499
50  9.10459587  9.28096284  6.96112585  7.48206047  8.31504082  6.24121451
51 11.66340742 11.76668680  9.49042154 10.02360737 10.85747610  8.79051737
52 10.16671032 10.02902265  8.43528453  8.90698449  9.28550788  7.28677874
53 10.11184181 10.16490248  8.08785990  8.59816537  9.28509568  7.22900436
54  9.64702092  9.53999033  7.90249506  8.37326550  8.77218942  6.76451944
55 10.10842395 10.37835870  7.77190166  8.31918502  9.35703465  7.27882124
56 12.65251807 12.89829777 10.25298111 10.81166947 11.89922259  9.82102443
57 11.49953227 11.44040456  9.57193183 10.07501322 10.64325752  8.61242862
58 10.08241351 10.09854718  8.11613188  8.61891005  9.24414828  7.19654197
59 11.06917318 11.20010552  8.88203943  9.41531770 10.27088127  8.20065544
60 10.47748830 10.50062618  8.47761383  8.98629915  9.64263387  7.59243842
            25          26          27          28          29          30
2                                                                         
3                                                                         
4                                                                         
5                                                                         
6                                                                         
7                                                                         
8                                                                         
9                                                                         
10                                                                        
11                                                                        
12                                                                        
13                                                                        
14                                                                        
15                                                                        
16                                                                        
17                                                                        
18                                                                        
19                                                                        
20                                                                        
21                                                                        
22                                                                        
23                                                                        
24                                                                        
25                                                                        
26  2.42474135                                                            
27  1.31059704  1.82005608                                                
28  1.64326319  0.78284567  1.26050964                                    
29  1.94896623  1.63305170  0.65652578  1.35948408                        
30  1.32696392  1.54406147  0.28484735  0.97893878  0.65125692            
31  9.88357562  8.22050438  9.94630828  8.68940230  9.85348282  9.66204208
32 10.15508641  8.37688740 10.13833003  8.89046033 10.00481961  9.85348282
33  8.90501464  7.25751133  8.97343401  7.71549023  8.89046033  8.68940230
34 10.16296795  8.50535070 10.23054025  8.97343401 10.13833003  9.94630828
35  8.53616238  6.74728654  8.50535070  7.25751133  8.37688740  8.22050438
36  9.92794618  8.53616238 10.16296795  8.90501464 10.15508641  9.88357562
37  8.07081456  6.68235568  8.29452630  7.03719978  8.29525809  8.01550508
38 10.04606067  8.75520509 10.34089978  9.08823428 10.36216333 10.06432417
39  9.73715982  7.91781618  9.68893687  8.44550880  9.54275030  9.40414893
40  9.27011415  7.39362252  9.17739759  7.94157550  9.01282772  8.89292609
41 10.73727089  9.71094080 11.18147688  9.95422320 11.27442417 10.91439950
42 10.94178933  9.54743733 11.18041634  9.92217689 11.16858407 10.90083860
43  9.02309556  7.47134012  9.15433726  7.89394513  9.10133950  8.87163828
44 10.00975603  8.28528692 10.03074731  8.77789122  9.91662264  9.74603669
45 10.33948014  8.43356999 10.22663368  8.99677336 10.04521599  9.94257477
46  9.12122777  7.54826548  9.23951463  7.97939881  9.17938226  8.95645713
47  9.59307225  7.54574843  9.36042917  8.16237425  9.12582254  9.07937125
48  8.89171738  7.25759237  8.96891348  7.71041919  8.89035678  8.68503587
49 10.68570442  8.98109235 10.72293361  9.46885455 10.61275889 10.43830550
50  8.09370991  6.30873136  8.06338975  6.81479018  7.93927150  7.77855015
51 10.65008720  8.86134254 10.62714263  9.38069034 10.48770132 10.34230189
52  9.15043439  7.70668838  9.34946478  8.08998648  9.32899450  9.06891558
53  9.09535973  7.41440900  9.14235919  7.88616652  9.04737889  8.85798561
54  8.63007261  7.17290679  8.81736595  7.55765164  8.79517577  8.53659034
55  9.10760392  7.18136453  8.97565363  7.74819582  8.79323653  8.69173051
56 11.65203545  9.69498426 11.49977626 10.28129370 11.29247742 11.21672217
57 10.48155575  8.88560875 10.59151088  9.33207140 10.51829242 10.30798259
58  9.06496025  7.43008980  9.14262265  7.88420256  9.06293200  8.85871980
59 10.05712546  8.25377945 10.02171644  8.77657466  9.87970461  9.73689215
60  9.46031259  7.80109077  9.52374559  8.26651571  9.43413762  9.23954604
            31          32          33          34          35          36
2                                                                         
3                                                                         
4                                                                         
5                                                                         
6                                                                         
7                                                                         
8                                                                         
9                                                                         
10                                                                        
11                                                                        
12                                                                        
13                                                                        
14                                                                        
15                                                                        
16                                                                        
17                                                                        
18                                                                        
19                                                                        
20                                                                        
21                                                                        
22                                                                        
23                                                                        
24                                                                        
25                                                                        
26                                                                        
27                                                                        
28                                                                        
29                                                                        
30                                                                        
31                                                                        
32  0.65125692                                                            
33  0.97893878  1.35948408                                                
34  0.28484735  0.65652578  1.26050964                                    
35  1.54406147  1.63305170  0.78284567  1.82005608                        
36  1.32696392  1.94896623  1.64326319  1.31059704  2.42474135            
37  2.06282943  2.58648290  1.27104459  2.29700250  1.66101528  1.86921191
38  1.81883840  2.43225933  2.08649760  1.78511606  2.86872925  0.49433028
39  0.85511021  0.49571178  1.13558900  1.00407888  1.20149372  2.16604331
40  1.32918454  1.08198569  1.15233566  1.53557770  0.82015276  2.54750875
41  3.26579840  3.84788324  3.53247521  3.19142968  4.30842260  1.96098786
42  1.82226007  2.26534491  2.49249989  1.64249356  3.23901058  1.01797680
43  0.96616906  1.51749307  0.45850602  1.20557319  1.22887098  1.22614594
44  0.33469139  0.31686213  1.13652137  0.40062425  1.54701016  1.64652540
45  1.40236104  0.76217675  1.89029523  1.41248855  1.86151977  2.71113691
46  0.84051601  1.38873651  0.42174637  1.08565307  1.20457316  1.22349481
47  2.23290159  1.75609321  2.18595935  2.36886595  1.68917881  3.52795474
48  0.99247911  1.39733752  0.06058805  1.27136463  0.82803554  1.60282456
49  0.81602153  0.70460226  1.78433797  0.56323845  2.24417436  1.70636770
50  1.94790383  2.07571206  1.07478830  2.22933441  0.44360269  2.68996256
51  0.98829516  0.49532365  1.83393320  0.84475711  2.12366017  2.12628238
52  1.20255660  1.83427494  0.96274925  1.36356997  1.72298585  0.84126801
53  0.80611322  1.13154134  0.23292780  1.09095922  0.79599366  1.66433066
54  1.48810662  2.04681637  0.83330612  1.71160109  1.45169085  1.36918671
55  1.65705550  1.39210101  1.37870510  1.86509060  0.85637952  2.85387489
56  2.42099577  1.81957394  3.14923506  2.28765162  3.19774734  3.53767042
57  0.72400236  1.07386454  1.63035753  0.47831384  2.26262336  1.10586401
58  0.82027313  1.25396767  0.17687804  1.09800774  0.93454701  1.49272566
59  0.75749182  0.17944658  1.33401009  0.81055503  1.52283410  2.07825701
60  0.42391054  0.88949286  0.55531518  0.70697448  1.16905541  1.40126608
            37          38          39          40          41          42
2                                                                         
3                                                                         
4                                                                         
5                                                                         
6                                                                         
7                                                                         
8                                                                         
9                                                                         
10                                                                        
11                                                                        
12                                                                        
13                                                                        
14                                                                        
15                                                                        
16                                                                        
17                                                                        
18                                                                        
19                                                                        
20                                                                        
21                                                                        
22                                                                        
23                                                                        
24                                                                        
25                                                                        
26                                                                        
27                                                                        
28                                                                        
29                                                                        
30                                                                        
31                                                                        
32                                                                        
33                                                                        
34                                                                        
35                                                                        
36                                                                        
37                                                                        
38  2.07823935                                                            
39  2.40661004  2.66029659                                                
40  2.34535495  3.03583464  0.58661034                                    
41  3.23412778  1.47139957  4.11701839  4.50708492                        
42  2.88716835  0.98583726  2.64548640  3.15143061  1.79191532            
43  1.09667651  1.64582717  1.43131056  1.57061426  3.07967211  2.14364944
44  2.31801048  2.13441940  0.60520154  1.15481162  3.56621433  2.04308880
45  3.16112363  3.19389936  0.75502570  1.07224248  4.60041376  2.96766291
46  1.22289886  1.66506963  1.31356718  1.48221796  3.11508767  2.10336295
47  3.32953814  4.02157431  1.37836138  1.03743287  5.48646578  4.00923687
48  1.21968862  2.04084939  1.18750023  1.21288429  3.48290279  2.46585316
49  2.86018621  2.13232958  1.19528067  1.78120095  3.43240025  1.71903599
50  1.58368529  3.10118273  1.64344997  1.21997775  4.49995349  3.56719107
51  3.02700632  2.57775202  0.94800590  1.51302747  3.91423287  2.21328660
52  1.08303770  1.19018841  1.85036914  2.05805161  2.59036266  1.84113394
53  1.50086253  2.13116161  0.90682791  0.98347720  3.59469830  2.44344817
54  0.59242021  1.67032861  1.93073362  1.98220901  2.98677412  2.37469250
55  2.48944198  3.33844415  0.90173538  0.32958764  4.80955767  3.47919597
56  4.40071989  3.96131832  2.04843993  2.40355235  5.19668449  3.41588965
57  2.49561863  1.51914495  1.47396033  2.01374777  2.83668032  1.19153132
58  1.33818573  1.94772794  1.09037389  1.19734985  3.40424911  2.32132645
59  2.58714544  2.56647725  0.34105832  0.91971449  3.99542047  2.43563772
60  1.70279642  1.88897681  0.84751138  1.14686699  3.36022280  2.09124174
            43          44          45          46          47          48
2                                                                         
3                                                                         
4                                                                         
5                                                                         
6                                                                         
7                                                                         
8                                                                         
9                                                                         
10                                                                        
11                                                                        
12                                                                        
13                                                                        
14                                                                        
15                                                                        
16                                                                        
17                                                                        
18                                                                        
19                                                                        
20                                                                        
21                                                                        
22                                                                        
23                                                                        
24                                                                        
25                                                                        
26                                                                        
27                                                                        
28                                                                        
29                                                                        
30                                                                        
31                                                                        
32                                                                        
33                                                                        
34                                                                        
35                                                                        
36                                                                        
37                                                                        
38                                                                        
39                                                                        
40                                                                        
41                                                                        
42                                                                        
43                                                                        
44  1.23227168                                                            
45  2.16214922  1.07014325                                                
46  0.12911351  1.10322234  2.03900240                                    
47  2.60790186  1.96891193  1.21717553  2.51753614                        
48  0.40511795  1.16553863  1.94156765  0.37933219  2.24653681            
49  1.76758468  0.69735294  1.27384377  1.64614248  2.41633873  1.80286609
50  1.46418329  1.97848116  2.28371847  1.47500895  1.95163441  1.10250547
51  1.93736751  0.70973312  0.80191106  1.80872172  1.99035051  1.86719564
52  0.50463309  1.52272217  2.54248920  0.57615257  3.09242310  0.90803920
53  0.58730038  0.92322741  1.66051021  0.50245979  2.02064001  0.28118274
54  0.53021241  1.76227362  2.67424862  0.65932515  3.01002189  0.77351291
55  1.82105936  1.48264380  1.25226191  1.74512274  0.84023332  1.43861210
56  3.33683461  2.11211868  1.33648978  3.20794866  2.20116505  3.19364939
57  1.45979875  0.86909444  1.78766929  1.36060784  2.82246138  1.62812466
58  0.37335632  1.00730768  1.83723818  0.29435408  2.23457092  0.17396407
59  1.54446977  0.43205814  0.64897329  1.41781278  1.57972922  1.37769057
60  0.62903298  0.61654658  1.54755427  0.50099152  2.14718111  0.57140089
            49          50          51          52          53          54
2                                                                         
3                                                                         
4                                                                         
5                                                                         
6                                                                         
7                                                                         
8                                                                         
9                                                                         
10                                                                        
11                                                                        
12                                                                        
13                                                                        
14                                                                        
15                                                                        
16                                                                        
17                                                                        
18                                                                        
19                                                                        
20                                                                        
21                                                                        
22                                                                        
23                                                                        
24                                                                        
25                                                                        
26                                                                        
27                                                                        
28                                                                        
29                                                                        
30                                                                        
31                                                                        
32                                                                        
33                                                                        
34                                                                        
35                                                                        
36                                                                        
37                                                                        
38                                                                        
39                                                                        
40                                                                        
41                                                                        
42                                                                        
43                                                                        
44                                                                        
45                                                                        
46                                                                        
47                                                                        
48                                                                        
49                                                                        
50  2.67558828                                                            
51  0.49436892  2.56701311                                                
52  1.90938936  1.91780183  2.18459813                                    
53  1.59066280  1.15973815  1.61128699  1.07813180                        
54  2.27464499  1.53907377  2.46603641  0.53383736  1.03723129            
55  2.09562262  1.17212793  1.79707571  2.31973088  1.24287667  2.18719250
56  1.83235867  3.61953136  1.44425782  3.62308996  2.91642114  3.86637127
57  0.61371679  2.65484759  1.07905858  1.45569370  1.49709092  1.90413631
58  1.63276803  1.24767829  1.71380431  0.86703005  0.21394432  0.84063145
59  0.87975714  1.96639105  0.60839734  1.89980453  1.10153771  2.06806460
60  1.23148345  1.54971572  1.32627672  1.00411354  0.39189491  1.15746894
            55          56          57          58          59
2                                                             
3                                                             
4                                                             
5                                                             
6                                                             
7                                                             
8                                                             
9                                                             
10                                                            
11                                                            
12                                                            
13                                                            
14                                                            
15                                                            
16                                                            
17                                                            
18                                                            
19                                                            
20                                                            
21                                                            
22                                                            
23                                                            
24                                                            
25                                                            
26                                                            
27                                                            
28                                                            
29                                                            
30                                                            
31                                                            
32                                                            
33                                                            
34                                                            
35                                                            
36                                                            
37                                                            
38                                                            
39                                                            
40                                                            
41                                                            
42                                                            
43                                                            
44                                                            
45                                                            
46                                                            
47                                                            
48                                                            
49                                                            
50                                                            
51                                                            
52                                                            
53                                                            
54                                                            
55                                                            
56  2.54443283                                                
57  2.34320678  2.44288435                                    
58  1.45270091  3.06303206  1.45618206                        
59  1.22263921  1.81605164  1.24518768  1.24899931            
60  1.45347204  2.70905083  1.10555083  0.40211289  0.91818875</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(x))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>hc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
hclust(d = dist(x))

Cluster method   : complete 
Distance         : euclidean 
Number of objects: 60 </code></pre>
</div>
</div>
<p>The print out above is not very useful (unlike that from kmeans) but there is a useful <code>plot()</code> method.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hc)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="at">h =</span> <span class="dv">10</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The length of the bars in height determines the distance between the points, the branches are an indicator of how far that point/grouping is to another one.</p>
<p>To get my main result (my cluster membership vector) I need to “cut” my tree using the function <code>cutree()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>grps <span class="ot">&lt;-</span> <span class="fu">cutree</span>(hc, <span class="at">h =</span> <span class="dv">10</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>grps</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2
[39] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">col =</span> grps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The cutting of the tree will determine where the grouping separation will take place. By lowering the cut, the number of groups that would be identified would change.</p>
</section>
<section id="principal-component-analysis-pca" class="level2">
<h2 class="anchored" data-anchor-id="principal-component-analysis-pca">Principal Component Analysis (PCA)</h2>
<p>The goal of PCA is to reduce the dimensionality of a dataset down to some smaller subset of new variables (called PCs) that are a useful bases for further analysis, like visualization, clustering, etc.</p>
<p>Read in the data given.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">"https://tinyurl.com/UK-foods"</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(url, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    England Wales Scotland N.Ireland
Cheese                  105   103      103        66
Carcass_meat            245   227      242       267
Other_meat              685   803      750       586
Fish                    147   160      122        93
Fats_and_oils           193   235      184       209
Sugars                  156   175      147       139
Fresh_potatoes          720   874      566      1033
Fresh_Veg               253   265      171       143
Other_Veg               488   570      418       355
Processed_potatoes      198   203      220       187
Processed_Veg           360   365      337       334
Fresh_fruit            1102  1137      957       674
Cereals                1472  1582     1462      1494
Beverages                57    73       53        47
Soft_drinks            1374  1256     1572      1506
Alcoholic_drinks        375   475      458       135
Confectionery            54    64       62        41</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">as.matrix</span>(x), <span class="at">beside =</span> T, <span class="at">col =</span> <span class="fu">rainbow</span>(<span class="fu">nrow</span>(x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The so-called “pairs” plot can be used for small datasets:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(x, <span class="at">col =</span> <span class="fu">rainbow</span>(<span class="fu">nrow</span>(x)), <span class="at">pch =</span> <span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>So the pairs plot is useful for small datasets but it can be losts of work to interpert and gets intractable for larger datasets.</p>
<p>The main function to do PCA in base R is called <code>prcomp()</code>. This function wants the transpose of our data in this case.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(<span class="fu">t</span>(x))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                            PC1      PC2      PC3       PC4
Standard deviation     324.1502 212.7478 73.87622 3.176e-14
Proportion of Variance   0.6744   0.2905  0.03503 0.000e+00
Cumulative Proportion    0.6744   0.9650  1.00000 1.000e+00</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$names
[1] "sdev"     "rotation" "center"   "scale"    "x"       

$class
[1] "prcomp"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>pca<span class="sc">$</span>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 PC1         PC2        PC3           PC4
England   -144.99315   -2.532999 105.768945 -4.894696e-14
Wales     -240.52915 -224.646925 -56.475555  5.700024e-13
Scotland   -91.86934  286.081786 -44.415495 -7.460785e-13
N.Ireland  477.39164  -58.901862  -4.877895  2.321303e-13</code></pre>
</div>
</div>
<p>A major PCA result viz is called a “PCA plot” (a.k.a: a score plot, biplot, PC1 vs PC2 plot, ordination plot)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>mycols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"orange"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pca<span class="sc">$</span>x[,<span class="dv">1</span>], pca<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="at">col =</span> mycols, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">xlab =</span> <span class="st">"PC1"</span>, <span class="at">ylab =</span><span class="st">"PC2"</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray"</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Another important output from PCA is called the “loadings” vector or the “rotation” component - this tells us how much the original variables (the foods in this case) contribute to the new PCs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>pca<span class="sc">$</span>rotation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                             PC1          PC2         PC3          PC4
Cheese              -0.056955380  0.016012850  0.02394295 -0.694538519
Carcass_meat         0.047927628  0.013915823  0.06367111  0.489884628
Other_meat          -0.258916658 -0.015331138 -0.55384854  0.279023718
Fish                -0.084414983 -0.050754947  0.03906481 -0.008483145
Fats_and_oils       -0.005193623 -0.095388656 -0.12522257  0.076097502
Sugars              -0.037620983 -0.043021699 -0.03605745  0.034101334
Fresh_potatoes       0.401402060 -0.715017078 -0.20668248 -0.090972715
Fresh_Veg           -0.151849942 -0.144900268  0.21382237 -0.039901917
Other_Veg           -0.243593729 -0.225450923 -0.05332841  0.016719075
Processed_potatoes  -0.026886233  0.042850761 -0.07364902  0.030125166
Processed_Veg       -0.036488269 -0.045451802  0.05289191 -0.013969507
Fresh_fruit         -0.632640898 -0.177740743  0.40012865  0.184072217
Cereals             -0.047702858 -0.212599678 -0.35884921  0.191926714
Beverages           -0.026187756 -0.030560542 -0.04135860  0.004831876
Soft_drinks          0.232244140  0.555124311 -0.16942648  0.103508492
Alcoholic_drinks    -0.463968168  0.113536523 -0.49858320 -0.316290619
Confectionery       -0.029650201  0.005949921 -0.05232164  0.001847469</code></pre>
</div>
</div>
<p>PCA looks to be a super useful method for gaining some insight into high dimensional data that is difficult to examine in other ways.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>